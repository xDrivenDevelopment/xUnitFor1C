Перем КонтекстЯдра;
Перем Ожидаем;

Перем ЗагрузчикИзПодсистемКонфигурации;
Перем ТипыУзловДереваТестов;

Процедура Инициализация(КонтекстЯдраПараметр) Экспорт
	КонтекстЯдра = КонтекстЯдраПараметр;
	Ожидаем = КонтекстЯдра.Плагин("УтвержденияBDD");
	ЗагрузчикИзПодсистемКонфигурации = КонтекстЯдра.Плагин("ЗагрузчикИзПодсистемКонфигурации");
	ТипыУзловДереваТестов = КонтекстЯдра.Плагин("ПостроительДереваТестов").ТипыУзловДереваТестов;
КонецПроцедуры

Функция ПолучитьСписокТестов() Экспорт
	ВсеТесты = Новый Массив;
	ВсеТесты.Добавить("ТестДолжен_Загрузить_Подсистему_Тестовая");
	ВсеТесты.Добавить("ТестДолжен_ВыполнитьТесты_Подсистемы_Тестовая");
	
	Возврат ВсеТесты;
КонецФункции

Процедура ТестДолжен_Загрузить_Подсистему_Тестовая() Экспорт
	ИмяПодсистемы = "Тестовая";
	ДеревоТестов = ЗагрузчикИзПодсистемКонфигурации.Загрузить(КонтекстЯдра, "Метаданные.Подсистемы." + ИмяПодсистемы);
	
	Ожидаем.Что(ДеревоТестов).ИмеетТип("Структура");
	Ожидаем.Что(ДеревоТестов.Имя).Равно(ИмяПодсистемы);
	Ожидаем.Что(ДеревоТестов.Тип).Равно(ТипыУзловДереваТестов.Контейнер);
	
	Ожидаем.Что(ДеревоТестов.Строки).ИмеетДлину(2);
КонецПроцедуры

Процедура ТестДолжен_ВыполнитьТесты_Подсистемы_Тестовая() Экспорт
	ИмяПодсистемы = "Тестовая";
	ДеревоТестов = ЗагрузчикИзПодсистемКонфигурации.Загрузить(КонтекстЯдра, "Метаданные.Подсистемы." + ИмяПодсистемы);
	
	РезультатыТестирования = КонтекстЯдра.ВыполнитьТесты(ЗагрузчикИзПодсистемКонфигурации, ДеревоТестов);
	
	Ожидаем.Что(РезультатыТестирования.КоличествоТестов, "КоличествоТестов").Равно(2);
	Ожидаем.Что(РезультатыТестирования.КоличествоСломаныхТестов, "КоличествоСломаныхТестов").Равно(0);
	Ожидаем.Что(РезультатыТестирования.КоличествоНеРеализованныхТестов, "КоличествоНеРеализованныхТестов").Равно(0);
КонецПроцедуры
